<html>
<head>
  <title>{{ hub.name }}</title>
  <link href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" />
</head>
<body>
<div class="header">
  <div class="padded center-block medium-wide">
    <h3>{{hub.name}}</h3>
    <h5>{{hub.summary}}</h5>
  </div>
</div>
<div class="container">
  <div class="row">
    <div class="col-md-{{ hub.left_width }}">
      {% for widget in hub.left_widgets %}
      <div id="widget-{{ widget.idx }}" class="row"></div>
      {% endfor %}
    </div>

    <div class="col-md-{{ hub.right_width }}">
      {% for widget in hub.right_widgets %}
      <div id="widget-{{ widget.idx }}" class="row"></div>
      {% endfor %}
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/jquery-1.10.2.min.js') }}"></script>
<script>
var widgets = [{% for widget in hub.widgets %}'{{ widget.idx }}',{% endfor %}];
$.each(widgets, function(i, widget) {
    $.ajax({
      url: widget,
      dataType: 'html',
      success: function(html) {
        $('#widget-' + widget).html(html);
        setTimeout(function() {
          $('#widget-' + widget + ' .panel').toggleClass('panel-visible');
        }, 100);
      },
      error: function() {
        console.log('error');
        console.trace();
      },
    });
});
</script>
</body></html>
